{% extends 'ta_app/base.html' %}
{% block content %}

<div class="wrapper">
  {% include "administrators/_sidebar.html" %}

  <div id="content" class="container-fluid">

    <h3>Job Details</h3>

    <div class="card">
      <ul class="list-group list-group-flush">
        <li class="list-group-item"><b>ID:</b> {{ job.id }}</li>
        <li class="list-group-item"><b>Title:</b> {{ job.title }}</li>
        <li class="list-group-item"><b>Description:</b> {{ job.description }}</li>
        <li class="list-group-item"><b>Session:</b> {{ job.session.year }} {{ job.session.term.name }} {{ job.session.title }}</li>
        <li class="list-group-item"><b>Qualification:</b> {{ job.qualification }}</li>
        <li class="list-group-item"><b>Is Active:</b> {{ job.is_active }}</li>
        <li class="list-group-item"><b>Created At:</b> {{ job.created_at }}</li>
        <li class="list-group-item"><b>Updated At:</b> {{ job.updated_at }}</li>
        <li class="list-group-item"><b>Note:</b> {{ job.note }}</li>
      </ul>
    </div>

    <h5 class="margin-top-30">Instructors</h5>
    <ul>
      {% for instructor in job.instructors.all %}
        <li>{{ instructor.first_name }} {{ instructor.last_name }}</li>
      {% empty %}
        No instructors found.
      {% endfor %}
    </ul>

    <p>
      Assgiend TA Hours: {{ job.assigned_ta_hours }} hours
    </p>

    <p>
      Applicants' TA Hours: {{ job.ta_hours }} hours
    </p>

    <h3 class="margin-top-30">Applications</h3>

    <table class="table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Applicant</th>
          <th>CWL</th>
          <th>Status</th>
          <th>Supervisor Approval</th>
          <th>How Qualified</th>
          <th>How Interested</th>
          <th>Availability</th>
          <th>Instructor Preference</th>
          <th>Classification</th>
          <th>Note</th>
          <th>Created At</th>
          <th>Updated At</th>
        </tr>
      </thead>
      <tbody>
        {% for app in job.application_set.all %}
          <tr>
            <td>{{ app.id }}</td>
            <td>{{ app.applicant.first_name }} {{ app.applicant.last_name }}</td>
            <td>{{ app.applicant.username }}</td>
            <td>
              <ul>
                {% for st in app.status.all %}
                  <li>{{ st.get_assigned_display }}: {{ st.assigned_hours }} hours at {{ st.created_at }}</li>
                {% endfor %}
              </ul>
            </td>
            <td>{{ app.supervisor_approval }}</td>
            <td>{{ app.get_how_qualified_display }}</td>
            <td>{{ app.get_how_interested_display }}</td>
            <td>{{ app.availability }}</td>
            <td>{{ app.get_instructor_preference_display }}</td>
            <td>{{ app.get_classification_display }}</td>
            <td>{{ app.note }}</td>
            <td>{{ app.created_at }}</td>
            <td>{{ app.updated_at }}</td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="7">No applications found.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    {% if path == 'current_sessions' or path == 'archived_sessions' %}
      <a href="{% url 'administrators:show_session' session_slug=job.session.slug path=path %}">Back to previous Session</a>
    {% else %}
      <a href="{% url 'administrators:type_jobs' type=path %}">Back to previous Jobs</a>
    {% endif %}
  </div>

</div>

{% endblock %}
