{% extends 'ta_app/base.html' %}
{% block content %}

<div class="wrapper">
  {% include "administrators/util/_sidebar.html" %}

  <div id="content" class="container-fluid">

    <h3>Student Jobs and Details</h3>

    <div>Student ID: {{ student.id }}</div>
    <div>First Name: {{ student.first_name }}</div>
    <div>Last Name: {{ student.last_name }}</div>
    <div>Preferred Name: {{ student.profile.preferred_name }}</div>
    <div>CWL: {{ student.username }}</div>
    <div>E-mail: {{ student.email }}</div>

    <hr />

    <h3>Offered Jobs</h3>

    		<h5>Summary</h5>
    		<table class="table">
    		  <thead>
    		    <tr>
    		      <th>Year-Term</th>
    		      <th>Total Assigned Hours</th>
    		    </tr>
    		  </thead>
    		  <tbody>
    		    {% for year_term, assigned_hours in offered_summary.items %}
    		      <tr>
    		        <td>{{ year_term }}</td>
    		        <td>{{ assigned_hours }} hours</td>
    		      </tr>
    		    {% empty %}
    		      <tr>
    		        <td colspan="2">No summary available</td>
    		      </tr>
    		    {% endfor %}
    		  </tbody>
    		</table>

    		<h5>List</h5>
    		<table class="table">
    		  <thead>
    		    <tr>
    		      <th>Year</th>
    		      <th>Term</th>
    		      <th>Job</th>
    		      <th>Assigned Status</th>
    		      <th>Assigned Hours</th>
    		    </tr>
    		  </thead>
    		  <tbody>
    		    {% for job in offered_jobs %}
    		    <tr>
    		      <td>{{ job.year }}</td>
    		      <td>{{ job.term }}</td>
    		      <td>
    		        <a href="{% url 'administrators:display_job_details' session_slug=job.session_slug job_slug=job.job_slug role='administrator' %}">
    		          {{ job.course_code }} {{ job.course_number }} {{ job.course_section }}
    		        </a>
    		      </td>
    		      <td>{{ job.assigned_status }}</td>
    		      <td>{{ job.assigned_hours }} hours</td>
    		    </tr>
    		    {% empty %}
    		      <tr>
    		        <td colspan="3">No offered jobs found</td>
    		      </tr>
    		    {% endfor %}
    		  </tbody>
    		</table>

    <hr />

    <h3>Accpeted Jobs</h3>

    <h5>Summary</h5>
    <table class="table">
      <thead>
        <tr>
          <th>Year-Term</th>
          <th>Total Assigned Hours</th>
        </tr>
      </thead>
      <tbody>
        {% for year_term, assigned_hours in accepted_summary.items %}
          <tr>
            <td>{{ year_term }}</td>
            <td>{{ assigned_hours }} hours</td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="2">No summary available</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <h5>List</h5>
    <table class="table">
      <thead>
        <tr>
          <th>Year</th>
          <th>Term</th>
          <th>Job</th>
          <th>Assigned Status</th>
          <th>Assigned Hours</th>
        </tr>
      </thead>
      <tbody>
        {% for job in accepted_jobs %}
        <tr>
          <td>{{ job.year }}</td>
          <td>{{ job.term }}</td>
          <td>
            <a href="{% url 'administrators:display_job_details' session_slug=job.session_slug job_slug=job.job_slug role='administrator' %}">
              {{ job.course_code }} {{ job.course_number }} {{ job.course_section }}
            </a>
          </td>
          <td>{{ job.assigned_status }}</td>
          <td>{{ job.assigned_hours }} hours</td>
        </tr>
        {% empty %}
          <tr>
            <td colspan="3">No accepted jobs found</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>


    <hr />

    <h3>Applications</h3>
    <table class="table table-responsive">
      <thead>
        <tr>
          <th>Application ID</th>
          <th>Year</th>
          <th>Term</th>
          <th>Job</th>
          <th>Assigned TA Hours</th>
          <th>Applicant TA Hours</th>
          <th>Status</th>
          <th>Created at</th>
          <th>Updated at</th>
        </tr>
      </thead>
      <tbody>
        {% for app in student.application_set.all %}
          <tr>
            <td>
              <a href="{% url 'administrators:display_application_details' app_slug=app.slug role='administrator' %}">
                {{ app.id }}
              </a>
            </td>
            <td>{{ app.job.session.year }}</td>
            <td>{{ app.job.session.term.code }}</td>
            <td>{{ app.job.course.code.name }} {{ app.job.course.number.name }} {{ app.job.course.section.name }}</td>
            <td>{{ app.job.assigned_ta_hours }} hours</td>
            <td>{{ app.job.ta_hours }} hours</td>
            <td>
              <ul>
                {% for st in app.applicationstatus_set.all %}
                  <li>{{ st.get_assigned_display }}: {{ st.assigned_hours }} hours on {{ st.created_at }}</li>
                {% empty %}
                  <li>No status found</li>
                {% endfor %}
              </ul>
            </td>
            <td>{{ app.created_at }}</td>
            <td>{{ app.updated_at }}</td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="6">No jobs found</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <a href="{% url 'administrators:student_jobs' %}">Go back to Jobs by Student</a>

  </div>
</div>

{% endblock %}
