{% extends 'ta_app/base.html' %}
{% block content %}
{% load admin_filters %}

{% include 'administrators/_menu.html' %}
<div class="row">
  <div class="col-md-4">
    {% include 'ta_app/pages/_left_aside.html' with view_name='sessions' title='Edit Session' data=session %}

    <div class="left-aside-btn-groups">
      <a class="btn btn-outline-primary" href="{{ next }}">Back to {{ request.GET.p }}</a>
    </div>

    <div class="col-10 mx-auto">
      {% include 'ta_app/pages/_session_note.html' %}

      {% if extra_courses|length > 0 %}
        <div class="text-center">
          <button type="button" class="btn btn-info mt-2" data-toggle="modal" data-target="#add-extra-courses-modal">
            Add Extra Courses ({{ extra_courses|length }})
          </button>
        </div>

        <div class="modal fade" id="add-extra-courses-modal" tabindex="-1" aria-labelledby="add-extra-courses-modal-label" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="add-extra-courses-modal-label">Add Extra Courses</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body font-weight-normal">
                <p>Here is the list of courses not included in the current job postings.</p>

                <form action="{% url 'administrators:add_extra_courses' %}" method="post">
                  {% csrf_token %}

                  <ul class="no-bullet list-no-ml">
                    {% for course in extra_courses %}
                      <li>
                        <input type="checkbox" name="courses[]" value="{{ course.id }}" />
                        {{ course|course_name }}
                      </li>
                    {% endfor %}
                  </ul>

                  <input type="hidden" name="next" value="{{ request.get_full_path }}" />
                  <input type="hidden" name="session_slug" value="{{ session.slug }}" />
                  <button class="btn btn-primary mt-4" type="submit">Add</button>
                </form>
              </div>
            </div>
          </div>
        </div>
      {% else %}
        <div class="text-center">
          <button type="button" class="btn btn-info mt-2" disabled>Add Extra Courses (0)</button>
        </div>
      {% endif %}
    </div>
  </div>

  <div class="col-md-8">
    <div class="board col-11 mx-auto">
      <h3>Edit Session Form</h3>

      <table class="user-data-table table table-borderless">
        <tbody>
          <tr>
            <td>Year:</td>
            <td>{{ session.year }}</td>
          </tr>
          <tr>
            <td>Term:</td>
            <td>{{ session.term.code }}</td>
          </tr>
        </tbody>
      </table>

      <form action="" method="post">
        {% csrf_token %}

        {% include 'administrators/subpages/form.html' %}

        <table class="user-data-table table table-borderless">
          <tbody>
            <tr>
              <td>
                Jobs <br />
                (Total: {{ jobs|length }})
              </td>
              <td>
                {% for job in jobs %}
                  <div>
                    <input name="jobs[]" value="{{ job.id }}" type="checkbox" {% if job.is_active %}checked{% endif %} />
                    {{ job|job_name }}
                  </div>
                {% empty %}
                  No jobs found.
                {% endfor %}
              </td>
            </tr>
          </tbody>
        </table>

        <input type="hidden" name="next" value="{{ next }}" />

        <a class="btn btn-outline-secondary" href="{{ next }}">Cancel</a>
        <input class="btn btn-primary" type="submit" value="Update" />
      </form>
    </div>
  </div>

</div>

{% endblock %}
