{% extends 'ta_app/base.html' %}
{% block content %}

{% include 'students/_menu.html' %}
<div class="row">
  <div class="col-md-4">
    {% include 'ta_app/pages/_left_aside.html' with view_name='users' title='View Profile' data=loggedin_user %}

    <div class="left-aside-btn-groups">
      <a class="btn btn-outline-primary" href="{% url 'students:edit_profile' %}">Edit Profile</a>
    </div>
  </div>

  <div class="col-md-8">

    <nav class="mb-4">
      <div class="nav nav-tabs" id="nav-tab" role="tablist">
        <a class="nav-item nav-link active" id="nav-basic-info-tab" data-toggle="tab" href="#nav-basic-info" role="tab" aria-controls="nav-basic-info" aria-selected="true">
          <i class="fa fa-user-circle-o" aria-hidden="true"></i> Basic Information
        </a>
        <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">
          <i class="fa fa-id-card-o" aria-hidden="true"></i> Profile
        </a>
        <a class="nav-item nav-link" id="nav-resume-tab" data-toggle="tab" href="#nav-resume" role="tab" aria-controls="nav-resume" aria-selected="false">
          <i class="fa fa-file-text-o" aria-hidden="true"></i> Resume
        </a>
      </div>
    </nav>

    <div class="tab-content" id="nav-tabContent">
      <div class="tab-pane fade show active" id="nav-basic-info" role="tabpanel" aria-labelledby="nav-basic-info-tab">
        <div class="board col-11 mx-auto">
          <h3>Basic Information</h3>
          {% include 'ta_app/users/_basic_info.html' with data=loggedin_user student_number_display='True' %}
        </div>
      </div>

      <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
        <div class="board col-11 mx-auto">
          <h3>Profile</h3>
          {% include 'ta_app/users/_profile.html' with data=loggedin_user %}
        </div>
      </div>

      <div class="tab-pane fade" id="nav-resume" role="tabpanel" aria-labelledby="nav-resume">

        <div class="board col-11 mx-auto">
          <h3>Resume</h3>

          {% if user.resume_filename %}
            <div>
              <a class="btn btn-link" href="{% url 'students:download_resume' username=loggedin_user.username filename=loggedin_user.resume_filename %}" target="_blank">
                <i class="fa fa-cloud-download" aria-hidden="true"></i> {{ loggedin_user.resume_filename }}
              </a>
              <br />
              <small class="text-muted">Uploaded at {{ loggedin_user.resume.created_at }}</small>
            </div>

            <div>
              <form action="{% url 'students:delete_resume' %}" method="post" onsubmit="return confirm('Are you sure to delete this resume?')">
                {% csrf_token %}
                <input type="hidden" name="user" value="{{ loggedin_user.username }}">
                <input class="btn btn-sm btn-danger" type="submit" value="Delete" />
              </form>
            </div>

          {% else %}

            <div>
              <button class="btn btn-secondary" type="button" disabled>
                <i class="fa fa-cloud-download" aria-hidden="true"></i> No resume
              </button>
            </div>

          {% endif %}

          <div class="card border-secondary mt-3">
            <div class="card-body">
              <div class="card-text">
                <h5 class="card-title">Upload your resume</h5>

                <small class="text-muted">Valid file formats: jpg, jpeg, png, pdf, doc, docx</small>
                <form action="{% url 'students:upload_resume' %}" method="post" enctype="multipart/form-data">
                  {% csrf_token %}
                  <table>{{ form.as_table }}</table>
                  <input class="btn btn-primary mt-4" type="submit" value="Upload" />
                </form>
              </div>
            </div>
          </div>
        </div>

      </div>

    </div>

  </div>
</div>

{% endblock %}
