{% extends 'ta_app/base.html' %}
{% block content %}

<div class="wrapper">
  {% include "students/_sidebar.html" %}

  <div id="content" class="container-fluid">
    {% if messages %}
      {% for message in messages %}
        <div class="alert {{ message.tags }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        </div>
      {% endfor %}
    {% endif %}

    <h3>Confidentiality</h3>

    {% if confidentiality and confidentiality.created_at != None %}

      <p>
        Employee Number: {{ confidentiality.employee_number }}
      </p>

      <div>
        SIN File:
        {% if user.sin_file %}
          <a href="{% url 'students:download_sin' username=user.username filename=user.sin_file %}" target="_blank">{{ user.sin_file }}</a>
          <form action="{% url 'students:delete_sin' %}" method="post" onsubmit="return confirm('Are you sure to delete this SIN?')">
            {% csrf_token %}
            <input type="hidden" name="user" value="{{ user.username }}">
            <input type="submit" value="Delete" />
          </form>
        {% else %}
          None
        {% endif %}
      </div>

      {% if user.confidentiality.is_international %}
        <div>
          SIN Expiry Date: {{ user.confidentiality.sin_expiry_date }}
        </div>

        <div>
          Study Permit File:
          {% if user.study_permit_file %}
            <a href="{% url 'students:download_study_permit' username=user.username filename=user.study_permit_file %}" target="_blank">{{ user.study_permit_file }}</a>
            <form action="{% url 'students:delete_study_permit' %}" method="post" onsubmit="return confirm('Are you sure to delete this study permit?')">
              {% csrf_token %}
              <input type="hidden" name="user" value="{{ user.username }}">
              <input type="submit" value="Delete" />
            </form>
          {% else %}
            None
          {% endif %}
        </div>
        <div>
          Study Permit Expiry Date: {{ confidentiality.study_permit_expiry_date }}
        </div>
      {% endif %}

      <a href="{% url 'students:edit_confidentiality' %}">Edit</a>

    {% else %}

      <div>
        If you are an international student, please click down below.
        <form action="{% url 'students:check_confidentiality' %}" method="post">
          {% csrf_token %}
          <input type="hidden" name="user" value="{{ user.id }}" />
          <input type="hidden" name="is_international" value="True" />
          <input type="submit" value="I am an international student" />
        </form>
      </div>

      or

      <div>
        If you are a Canadian citizen or Permanent Resident, please click down below.
        <form action="{% url 'students:check_confidentiality' %}" method="post">
          {% csrf_token %}
          <input type="hidden" name="user" value="{{ user.id }}" />
          <input type="hidden" name="is_international" value="False" />
          <input type="submit" value="I am a Canadian citizen/Permanent Resident" />
        </form>
      </div>

    {% endif %}
  </div>
</div>


{% endblock %}
