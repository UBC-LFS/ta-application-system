{% extends 'ta_app/base.html' %}
{% block content %}

{% include 'students/_menu.html' %}
<div class="row">
  <div class="col-md-4">
    {% include 'ta_app/pages/_left_aside.html' with view_name='users'   title='Edit Confidential Info.' data=loggedin_user %}

    <div class="left-aside-btn-groups">
      <a class="btn btn-outline-primary" href="{% url 'students:show_confidentiality' %}">Back to Confidential Info.</a>
    </div>

    <div class="bd-callout bd-callout-warning bg-light-gray col-10 mx-auto font-size-xs">
      {% include 'ta_app/pages/_required_docs_confidentiality.html' with data=loggedin_user.confidentiality.nationality %}
    </div>
  </div>

  <div class="col-md-8">

    <div class="board col-11 mx-auto">
      <h3>Confidential Infomation Edit Form</h3>

      {% include 'ta_app/pages/_upload_message.html' %}

      <form action="" method="post" enctype="multipart/form-data">
        {% csrf_token %}

        {% for field in form.visible_fields  %}
          <div class="field-wrapper">
            {{ field.label_tag }}
            {% if field.help_text %}
              <div class="help">{{ field.help_text|safe }}</div>
            {% endif %}
            {{ field }}
          </div>
        {% endfor %}

        {% for field in form.hidden_fields %}
          {{ field }}
        {% endfor %}

        <a class="btn btn-outline-secondary" href="{% url 'students:show_confidentiality' %}">Cancel</a>
        <input class="btn btn-primary" type="submit" value="Update" />
      </form>

      <div class="card border-secondary mt-5">
        <div class="card-body">
          <h5 class="card-title text-info">Delete uploaded files</h5>
          <p class="text-danger">
            <i class="fa fa-asterisk" aria-hidden="true"></i>
            Your files will be deleted permanently when you click on the Delete button.
          </p>

          <form action="{% url 'students:delete_confidential_information' %}" method="post" onsubmit="return confirm('Are you sure to delete your confidential information?')">
            {% csrf_token %}

            {% if loggedin_user.confidentiality.employee_number %}
              <div class="field-wrapper">
                <i class="fa fa-file-text-o text-secondary" aria-hidden="true"></i> Employee Number:
                <input id="id_employee_number"type="checkbox" name="employee_number" /><br />
                <small class="text-muted">{{ loggedin_user.confidentiality.employee_number }}</small>
              </div>
            {% endif %}

            {% if loggedin_user.confidentiality.sin %}
              <div class="field-wrapper">
                <i class="fa fa-file-image-o text-success" aria-hidden="true"></i> SIN:
                <input id="id_sin" type="checkbox" name="sin" /><br />
                <small class="text-muted">{{ sin_file }}</small>
              </div>
            {% endif %}

            {% if loggedin_user.confidentiality.nationality == '1' %}

              {% if loggedin_user.confidentiality.sin_expiry_date %}
                <div class="field-wrapper">
                  <i class="fa fa-file-text-o text-secondary" aria-hidden="true"></i> SIN Expiry Date:
                  <input id="id_sin_expiry_date" type="checkbox" name="sin_expiry_date" /><br />
                  <small class="text-muted">{{ loggedin_user.confidentiality.sin_expiry_date }}</small>
                </div>
              {% endif %}

              {% if loggedin_user.confidentiality.study_permit %}
                <div class="field-wrapper">
                  <i class="fa fa-file-image-o text-success" aria-hidden="true"></i> Study Permit:
                  <input id="id_study_permit" type="checkbox" name="study_permit" /><br />
                  <small class="text-muted">{{ study_permit_file }}</small>
                </div>
              {% endif %}

              {% if loggedin_user.confidentiality.study_permit_expiry_date %}
                <div class="field-wrapper">
                  <i class="fa fa-file-text-o text-secondary" aria-hidden="true"></i> Study Permit Expiry Date:
                  <input id="id_study_permit_expiry_date" type="checkbox" name="study_permit_expiry_date" /><br />
                  <small class="text-muted">{{ loggedin_user.confidentiality.study_permit_expiry_date }}</small>
                </div>
              {% endif %}
            {% endif %}

            {% if loggedin_user.confidentiality.personal_data_form %}
              <div class="field-wrapper">
                <i class="fa fa-file-word-o text-primary" aria-hidden="true"></i> Personal Data Form:
                <input id="personal_data_form" type="checkbox" name="personal_data_form" /><br />
                <small class="text-muted">{{ personal_data_form_file }}</small>
              </div>
            {% endif %}

            <input type="hidden" name="user" value="{{ loggedin_user.username }}" />
            <input class="btn btn-outline-danger btn-sm mt-1" type="submit" value="Delete Confidential Information" />
          </form>
        </div>
      </div>
    </div>

  </div>
</div>

{% endblock %}
