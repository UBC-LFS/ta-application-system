{% extends 'ta_app/base.html' %}
{% block content %}

{% include 'students/_menu.html' %}
<div class="row">
  <div class="col-md-4">
    {% include 'ta_app/pages/_left_aside.html' with view_name='users'   title='Edit Confidential Info.' data=loggedin_user %}

    <div class="left-aside-btn-groups">
      <a class="btn btn-outline-primary" href="{% url 'students:show_confidentiality' %}">Back to Confidential Info.</a>
    </div>
  </div>

  <div class="col-md-8">

    <div class="board col-11 mx-auto">
      <h3>Confidential Infomation Edit Form</h3>

      <div class="bd-callout bd-callout-warning bg-light-gray">
        <h4>
          <i class="fa fa-bullhorn" aria-hidden="true"></i> Notice
        </h4>
        <p>
          <i class="fa fa-check" aria-hidden="true"></i>
          If you would like to change your SIN or Study Permit, please delete your old information first, and then update your new one.
        </p>
        <p>
          <i class="fa fa-check" aria-hidden="true"></i>
          You are an Canadian domestic student if you are:
          <ul>
            <li>an Canadian citizen</li>
            <li>an Canadian permanent resident</li>
          </ul>
        </p>
      </div>

      {% include 'ta_app/pages/_upload_message.html' %}

      <form action="" method="post" enctype="multipart/form-data">
        {% csrf_token %}

        {% for field in form.visible_fields  %}
          <div class="field-wrapper">
            {{ field.label_tag }}
            {% if field.help_text %}
              <div class="help">{{ field.help_text|safe }}</div>
            {% endif %}
            {{ field }}
          </div>
        {% endfor %}

        {% for field in form.hidden_fields %}
          {{ field }}
        {% endfor %}

        <a class="btn btn-outline-secondary" href="{% url 'students:show_confidentiality' %}">Cancel</a>
        <input class="btn btn-primary" type="submit" value="Update" />
      </form>

      <div class="card border-danger my-4">
        <div class="card-body">
          <h5 class="card-title text-secondary">Delete SIN</h5>

          {% if loggedin_user.confidentiality.sin %}
            <small class="text-muted">File: {{ sin_file }}</small>
            <form action="{% url 'students:delete_sin' %}" method="post" onsubmit="return confirm('Are you sure to delete this SIN file?')">
              {% csrf_token %}
              <input type="hidden" name="user" value="{{ loggedin_user.username }}" />
              <input class="btn btn-danger mt-3" type="submit" value="Delete SIN" />
            </form>
          {% else %}
            <small class="text-muted">No SIN information</small>
          {% endif %}
        </div>
      </div>

      {% if loggedin_user.confidentiality.nationality == '1' %}
        <div class="card border-danger my-4">
          <div class="card-body">
            <h5 class="card-title text-secondary">Delete Study Permit</h5>

            {% if loggedin_user.confidentiality.study_permit %}
              <small class="text-muted">File: {{ study_permit_file }}</small>
              <form action="{% url 'students:delete_study_permit' %}" method="post" onsubmit="return confirm('Are you sure to delete this Study Permit file?')">
                {% csrf_token %}
                <input type="hidden" name="user" value="{{ loggedin_user.username }}" />
                <input class="btn btn-danger mt-3" type="submit" value="Delete Study Permit" />
              </form>
            {% else %}
              <small class="text-muted">No Study Permit information</small>
            {% endif %}
          </div>
        </div>
      {% endif %}

    </div>

  </div>
</div>

{% endblock %}
