{% extends "ta_app/base.html" %}
{% block content %}
{% load static %}
{% include "students/util/_sidebar.html" %}

<div id="content" class="container-fluid">
  {% include 'ta_app/_return_messages.html' with data=messages %}

  <div class="mb-3">
    <img class="ubc-logo d-inline-block" src="{% static 'ta_app/images/UBClogo.jpeg' %}" alt="ubc logo" />
    <div class="d-inline-block ml-3">
      <h3>{{ session.year }} {{ session.term.name }} ({{ session.term.code }})</h3>
      <a class="btn btn-outline-primary" href="{% url 'students:explore_jobs' %}">Go back to Explore Jobs</a>
    </div>
  </div>

  <div class="d-inline-block">
    <h5 class="mt-3">Available Jobs</h5>
    <div class="text-secondary">Total: {{ jobs|length }}</div>

    <table class="table table-bordered table-hover table-striped table-responsive-md text-center" data-toggle="table" data-sortable="true" data-classes="" data-pagination="true" data-search="true">
      <thead>
        <tr>
          <th data-sortable="true">Year</th>
          <th data-sortable="true">Term</th>
          <th data-sortable="true">Job</th>
          <th data-sortable="true">Instructors</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for job in jobs %}
          <tr>
            <td>{{ job.session.year }}</td>
            <td>{{ job.session.term.code }}</td>
            <td class="text-left">
              {{ job.course.code.name }} {{ job.course.number.name }} {{ job.course.section.name }}
              - <small class="text-muted">{{ job.course.name }}</small>
              {% include 'administrators/util/_modal_job_details.html' with data=job role='student' %}
            </td>
            <td>
              {% for instructor in job.instructors.all %}
                {{ instructor.first_name }} {{ instructor.last_name }},
              {% endfor %}
            </td>
            <td>
              {% if job.app %}
                <span class="badge badge-info">APPLIED</span>
                <small class="text-muted">{{ job.app.created_at }}</small>
              {% else %}
                <a href="{% url 'students:apply_job' session_slug=job.session.slug job_slug=job.course.slug %}">Apply</a>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

  </div>

</div>

{% endblock %}
