{% extends "ta_app/base.html" %}
{% block content %}

{% include 'students/_menu.html' %}
<div class="row">
  <div class="col-md-4">
    {% include 'ta_app/pages/_left_aside.html' with view_name='users' title='Available Jobs' data=loggedin_user  %}

    <div class="left-aside-btn-groups">
      <a class="btn btn-outline-primary" href="{% url 'students:explore_jobs' %}">Back to Explore Jobs</a>
    </div>
  </div>

  <div class="col-md-8">
    <div class="col-11 mx-auto">
      <h3 class="text-primary mb-5">Apply Now!</h3>

      <div class="search-field bg-light-gray p-4">
        <form method="GET">
          <input type="text" name="code" value="{{ request.GET.code }}" placeholder="Job Code" /> and
          <input type="text" name="number" value="{{ request.GET.number }}" placeholder="Job Number" /> and
          <input type="text" name="section" value="{{ request.GET.section }}" placeholder="Job Section" /> <br />
          <input type="text" name="instructor" value="{{ request.GET.instructor }}" placeholder="Instructor First Name" /> <br />
          <button class="btn btn-sm btn-secondary" type="submit">Search</button>
          <a class="btn btn-sm btn-light" href="{% url 'students:available_jobs' session_slug=session_slug %}">Clear</a>
        </form>
      </div>
      <div class="mb-4">{{ jobs|length }} row{% if jobs|length > 1 %}s {% endif %} in this page</div>

      <table
        class="table table-bordered table-hover table-striped table-responsive-md text-center font-size-1"
        data-toggle="table"
        data-sortable="true"
        data-classes=""
      >
        <thead>
          <tr>
            <th data-sortable="true">Year</th>
            <th data-sortable="true">Term</th>
            <th data-sortable="true">Job</th>
            <th data-sortable="true">Instructors</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for job in jobs %}
            <tr>
              <td>{{ job.session.year }}</td>
              <td>{{ job.session.term.code }}</td>
              <td class="text-left">
                {{ job.course.code.name }} {{ job.course.number.name }} {{ job.course.section.name }}
                {% include 'ta_app/jobs/_modal_job_details.html' with data=job %}

                {% if job.my_fav %}
                  <i class="fa fa-star text-warning" aria-hidden="true"></i>
                {% endif %}
              </td>
              <td>{% include 'ta_app/jobs/_job_instructor.html' with data=job %}</td>
              <td>

                {% if job.my_app %}
                  {% include 'ta_app/applications/_app_status.html' with data='None' %}
                  <br />
                  <small class="text-muted">{{ job.my_app.created_at }}</small>
                {% else %}
                  <a href="{% url 'students:apply_job' session_slug=job.session.slug job_slug=job.course.slug %}">Apply</a>
                {% endif %}

              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>

      {% include 'ta_app/pages/_table_paginator.html' with data=jobs %}

    </div>
  </div>
</div>

{% endblock %}
