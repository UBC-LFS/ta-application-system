{% extends "ta_app/base.html" %}
{% block content %}

<div class="wrapper">
  {% include "students/_sidebar.html" %}

  <div id="content" class="container-fluid">

    {% if messages %}
    	{% for message in messages %}
        <div class="alert {{ message.tags }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        </div>
    	{% endfor %}
    {% endif %}

    <h3 class="margin-top-30">{{ session.year }} {{ session.term.name }} {{ session.title }}</h3>

    <h5 class="margin-top-30">Available Jobs</h5>

    <table class="table">
      <thead>
        <tr>
          <th>Year</th>
          <th>Term</th>
          <th>Job</th>
          <th>Title</th>
          <th>Instructors</th>
          <th>Job Details</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for job in jobs %}
          {% if job.is_active %}
            <tr>
              <td>{{ job.session.year }}</td>
              <td>{{ job.session.term.code }}</td>
              <td>{{ job.course.code.name }} {{ job.course.number.name }} {{ job.course.section.name }}</td>
              <td>
                {{ job.course.name }}
              </td>
              <td>
                {% for instructor in job.instructors.all %}
                  {{ instructor.first_name }} {{ instructor.last_name }}
                {% endfor %}
              </td>
              <td>
                <button type="button" class="btn btn-sm btn-info" data-toggle="modal" data-target="#job-list-modal-{{ job.id }}">
                  View
                </button>
                <div class="modal fade" id="job-list-modal-{{ job.id }}" tabindex="-1" role="dialog" aria-labelledby="job-list-modal-label-{{ job.id }}" aria-hidden="true">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="job-list-modal-label-{{ job.id }}">Job Details</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div>
                      <div class="modal-body">
                        <h5>
                          {{ job.session.year }} {{ job.session.term.code }} - {{ job.course.code.name }} {{ job.course.number.name }} {{ job.course.section.name }}
                        </h5>
                        <p>{{ job.course.name }}</p>
                        <ul>
                          <li>
                            Intstructors:
                            {% for instructor in job.instructors.all %}
                              {{ instructor.username }},
                            {% empty %}
                              No instructors
                            {% endfor %}
                          </li>
                        </ul>

                        <p>Job Title:</p>
                        <p>{{ job.title }}</p>

                        <p>Job Description:</p>
                        <p>{{ job.description }}</p>

                        <p>Job Qalification:</p>
                        <p>{{ job.qualification }}</p>

                        <p>Job Note:</p>
                        <p>{{ job.note }}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </td>
              <td>
                  <a href="{% url 'students:apply_job' session_slug=job.session.slug job_slug=job.course.slug %}">
                    {% if job.has_applied %}
                      Applied
                    {% else %}
                      Apply
                    {% endif %}
                  </a>
              </td>
            </tr>
          {% endif %}
        {% empty %}
          No jobs available yet.
        {% endfor %}
      </tbody>
    </table>

  </div>
</div>

{% endblock %}
