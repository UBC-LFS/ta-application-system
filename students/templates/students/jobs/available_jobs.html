{% extends "ta_app/base.html" %}
{% block content %}

{% include 'students/_menu.html' %}
{% include 'ta_app/_return_messages.html' with data=messages %}
<div class="row">
  <div class="col-md-4">
    {% include 'ta_app/pages/_header.html' with title='Available Jobs' text=jobs|length %}

    <div class="bg-prompt">
      <div class="prompt p-4 mb-4">
        <h4>{{ loggedin_user.get_full_name }}</h4>
				<p>{{ loggedin_user.username }}</p>

        <a class="btn btn-sm btn-outline-primary" href="{% url 'students:explore_jobs' %}">Explore Jobs</a>
      </div>
    </div>

    <div>
			{% include 'students/jobs/_recent_applied_jobs.html' with data=applied_jobs %}
		</div>

  </div>

  <div class="col-md-8">

    <table class="table table-bordered table-hover table-striped table-responsive-md text-center" data-toggle="table" data-sortable="true" data-classes="" data-pagination="true" data-search="true">
      <thead>
        <tr>
          <th data-sortable="true">Year</th>
          <th data-sortable="true">Term</th>
          <th data-sortable="true">Job</th>
          <th data-sortable="true">Instructors</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for job in jobs %}
          <tr>
            <td>{{ job.session.year }}</td>
            <td>{{ job.session.term.code }}</td>
            <td class="text-left">
              {{ job.course.code.name }} {{ job.course.number.name }} {{ job.course.section.name }}
              - <small class="text-muted">{{ job.course.name }}</small>
              {% include 'ta_app/jobs/_modal_job_details.html' with data=job %}
            </td>
            <td>
              {% for instructor in job.instructors.all %}
                <div>{{ instructor.get_full_name }}</div>
              {% empty %}
                No instructors found.
              {% endfor %}
            </td>
            <td>

              {% if job.app %}
                {% include 'ta_app/applications/_app_status.html' with data='None' %}
                <br />
                <small class="text-muted">{{ job.app.created_at }}</small>
              {% else %}
                <a href="{% url 'students:apply_job' session_slug=job.session.slug job_slug=job.course.slug %}">Apply</a>
              {% endif %}
              
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

  </div>
</div>

{% endblock %}
