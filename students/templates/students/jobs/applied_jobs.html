{% extends 'ta_app/base.html' %}
{% block content %}

<div class="wrapper">
    {% include "students/_sidebar.html" %}

  <div id="content" class="container-fluid">
    <h3>Applied Jobs</h3>


    <table class="table">
      <thead>
        <tr>
          <th>Year</th>
          <th>Term</th>
          <th>Job</th>
          <th>Application</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        {% for job in applied_jobs %}
          <tr>
            <td>{{ job.session.year }}</td>
            <td>{{ job.session.term.code }}</td>
            <td>{{ job.course.code.name }} {{ job.course.number.name }} {{ job.course.section.name }}</td>
            <td>

              <button type="button" class="btn btn-sm btn-info" data-toggle="modal" data-target="#job-application-modal-{{ job.id }}">
                View
              </button>
              <div class="modal fade" id="job-application-modal-{{ job.id }}" tabindex="-1" role="dialog" aria-labelledby="job-application-modal-label-{{ job.id }}" aria-hidden="true">
                <div class="modal-dialog modal-lg" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="job-application-modal-label-{{ job.id }}">My Application</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <h5>
                        {{ job.session.year }} {{ job.session.term.code }} - {{ job.course.code.name }} {{ job.course.number.name }} {{ job.course.section.name }}
                      </h5>
                      <p>{{ job.course.name }}</p>
                      <ul>
                        <li>
                          Intstructors:
                          {% for instructor in job.instructors.all %}
                            {{ instructor.username }},
                          {% empty %}
                            No instructors
                          {% endfor %}
                        </li>
                      </ul>

                      <p>Job Title:</p>
                      <p>{{ job.title }}</p>

                      <p>Job Description:</p>
                      <p>{{ job.description }}</p>

                      <p>Job Qalification:</p>
                      <p>{{ job.qualification }}</p>

                      <p>Job Note:</p>
                      <p>{{ job.note }}</p>

                      <p>Supervisor Approval: {{ job.my_application.supervisor_approval }}</p>
                      <p>How Qualified: {{ job.my_application.get_how_qualified_display }}</p>
                      <p>How Interested: {{ job.my_application.get_how_interested_display }}</p>
                      <p>Availability: {{ job.my_application.availability }}</p>
                      <p>Availability Note: {{ job.my_application.availability_note }}</p>
                    </div>
                  </div>
                </div>
              </div>

            </td>
            <td>
              {% for app in job.application_set.all %}
                {% if app.applicant.id == user.id %}
                  <ul>
                    {% for st in app.status.all %}
                      <li>
                        {{ st.get_assigned_display }}: {{ st.assigned_hours }} hours ({{ st.created_at }})
                      </li>
                    {% endfor %}
                  </ul>
                {% endif %}
              {% endfor %}
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="5">No jobs applied yet</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>


  </div>
</div>

{% endblock %}
